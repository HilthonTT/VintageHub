@inject IUserEndpoint UserEndpoint
@inject NavigationManager Navigation

<MudCard Outlined="true" Class="mb-3">
    <MudCardContent>
        <MudGrid>
            <MudItem xs="12">
                <MudText Typo="Typo.body1">@Review.Title</MudText>
                <MudDivider Class="mt-3 mb-3"/>
                <MudText Typo="Typo.body2">@Review.Description</MudText>
                <MudText Typo="Typo.subtitle1">Written by: @reviewerFullName</MudText>
            </MudItem>
            <MudItem xs="12">
                <MudRating SelectedValue="Review.Rating" ReadOnly="true" />
            </MudItem>
        </MudGrid>
    </MudCardContent>
    <MudCardActions>
        <MudButton StartIcon="@Icons.Material.Filled.AdsClick" OnClick="LoadReviewPage">
            View Details
        </MudButton>
    </MudCardActions>
</MudCard>

@code {
    [Parameter]
    [EditorRequired]
    public ReviewModel Review { get; set; }

    [Parameter]
    [EditorRequired]
    public ArtifactModel Artifact { get; set; }

    private UserModel reviewer;
    private string reviewerFullName = "";

    protected override async Task OnInitializedAsync()
    {
        reviewer = await UserEndpoint.GetUserByIdAsync(Review.UserId);
        reviewerFullName = $"{reviewer?.FirstName} {reviewer?.LastName}";
    }

    private void LoadReviewPage()
    {
        Navigation.NavigateTo($"/Artifact/{Artifact.Id}/Review/{Review.Id}");
    }
}
