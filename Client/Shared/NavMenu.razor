@inject IShoppingCartStorage ShoppingCartStorage
@inject NavigationManager Navigation

<MudAppBar Color="Color.Dark">
    <AuthorizeView>
        <Authorized>
            <MudButton OnClick="LoadHomePage" StartIcon="@Icons.Material.Filled.Home">
                Home
            </MudButton>
            <MudButton OnClick="LoadListingPage" StartIcon="@Icons.Material.Filled.List">
                Our Artifacts
            </MudButton>
            <MudButton OnClick="LoadCartPage" StartIcon="@Icons.Material.Filled.ShoppingCart">
                Cart [@shoppingCart?.CartItems.Count]
            </MudButton>

            <MudSpacer />
            <MudText>Hello, @context.User.Identity?.Name!</MudText>
            <MudButton OnClick="BeginLogOut"
                       StartIcon="@Icons.Material.Filled.Logout">Logout</MudButton>
        </Authorized>
        <NotAuthorized>
            <MudButton OnClick="LoadHomePage" StartIcon="@Icons.Material.Filled.Home">
                Home
            </MudButton>
            <MudButton OnClick="LoadListingPage" StartIcon="@Icons.Material.Filled.List">
                Our Artifacts
            </MudButton>
            <MudSpacer />
            <MudButton OnClick="BeginLogIn" StartIcon="@Icons.Material.Filled.Login">
                Login
            </MudButton>
        </NotAuthorized>
    </AuthorizeView>
</MudAppBar>

@code {
    private ShoppingCartModel shoppingCart;

    protected override async Task OnInitializedAsync()
    {
        shoppingCart = await ShoppingCartStorage.GetShoppingCartAsync();
    }

    private void BeginLogOut()
    {
        Navigation.NavigateToLogout("authentication/logout");
    }

    private void BeginLogIn()
    {
        Navigation.NavigateToLogin("authentication/login");
    }

    private void LoadHomePage()
    {
        Navigation.NavigateTo("/");
    }

    private void LoadCartPage()
    {
        Navigation.NavigateTo("/Cart");
    }

    private void LoadListingPage()
    {
        Navigation.NavigateTo("/Listing");
    }
}
